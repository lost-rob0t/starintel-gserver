{"_id":"_design/search","views":{},"language":"javascript","indexes":{"fts":{"analyzer":{"name":"perfield","default":"standard","fields":{}},"index":"function(doc) { \n  index('dataset', doc.dataset, {\"store\": \"yes\", \"field\": \"dataset\"});\n  index('date_added', doc.date_added, {\"store\": \"yes\", \"field\": \"date_added\"});\n  index('date_updated', doc.date_updated, {\"store\": \"yes\", \"field\": \"date_updated\"});\n  index('dtype', doc.dtype, {\"store\": \"yes\", \"field\": \"dtype\"});\n  if (doc.dtype == \"Entity\") {\n        var total = doc.etype + \" \" + doc.eid;\n        index('etype', doc.etype, {\"store\": \"yes\", \"field\": \"etype\"});\n        index('eid', doc.eid, {\"store\": \"yes\", \"field\": \"eid\"});\n        if (doc.dataset) {\n            index('dataset', doc.dataset, {\"store\": \"yes\", \"field\": \"dataset\"});\n        }\n        if (doc.date_added) {\n            index('date_added', doc.date_added, {\"store\": \"yes\", \"field\": \"date_added\"});\n        }\n        if (doc.date_updated) {\n            index('date_updated', doc.date_updated, {\"store\": \"yes\", \"field\": \"date_updated\"});\n        }\n    }\n    if (doc.dtype == \"Org\") {\n        var total = doc.reg + \" \" + doc.country + \" \" + doc.name + \" \" + doc.website + \" \" + doc.bio;\n        index('reg', doc.reg, {\"store\": \"yes\", \"field\": \"reg\"});\n        index('country', doc.country, {\"store\": \"yes\", \"field\": \"country\"});\n        index('name', doc.name, {\"store\": \"yes\", \"field\": \"name\"});\n        index('website', doc.website, {\"store\": \"yes\", \"field\": \"website\"});\n        index('bio', doc.bio, {\"store\": \"yes\", \"field\": \"bio\"});\n    }\n    if (doc.dtype == \"Person\") {\n        var total = doc.fname + \" \" + doc.mname + \" \" + doc.lname + \" \" + doc.bio + \" \" + doc.dob + \" \" + doc.gender + \" \" + doc.race + \" \" + doc.region + \" \" + JSON.stringify(doc.misc);\n        index('fname', doc.fname, {\"store\": \"yes\", \"field\": \"fname\"});\n        index('mname', doc.mname, {\"store\": \"yes\", \"field\": \"mname\"});\n        index('lname', doc.lname, {\"store\": \"yes\", \"field\": \"lname\"});\n        index('bio', doc.bio, {\"store\": \"yes\", \"field\": \"bio\"});\n        index('dob', doc.dob, {\"store\": \"yes\", \"field\": \"dob\"});\n        index('gender', doc.gender, {\"store\": \"yes\", \"field\": \"gender\"});\n        index('race', doc.race, {\"store\": \"yes\", \"field\": \"race\"});\n        index('region', doc.region, {\"store\": \"yes\", \"field\": \"region\"});\n        if (doc.misc) {\n            index('misc', JSON.stringify(doc.misc), {\"store\": \"yes\", \"field\": \"misc\"});\n        }\n    }\n        if (doc.dtype == \"Message\") {\n        var total = doc.message + \" \" + doc.platform + \" \" + doc.user + \" \" + doc.message_id + \" \" + doc.reply_to + \" \" + doc.group + \" \" + doc.channel + \" \" + JSON.stringify(doc.mentions);\n        index('message', doc.message, {\"store\": \"yes\", \"field\": \"message\"});\n        index('platform', doc.platform, {\"store\": \"yes\", \"field\": \"platform\"});\n        index('user', doc.user, {\"store\": \"yes\", \"field\": \"user\"});\n        index('message_id', doc.message_id, {\"store\": \"yes\", \"field\": \"message_id\"});\n        index('reply_to', doc.reply_to, {\"store\": \"yes\", \"field\": \"reply_to\"});\n        index('group', doc.group, {\"store\": \"yes\", \"field\": \"group\"});\n        index('channel', doc.channel, {\"store\": \"yes\", \"field\": \"channel\"});\n        if (doc.mentions) {\n            index('mentions', JSON.stringify(doc.mentions), {\"store\": \"yes\", \"field\": \"mentions\"});\n        }\n    }\n    if (doc.dtype == \"SocialMPost\") {\n        var total = doc.content + \" \" + doc.user + \" \" + JSON.stringify(doc.replies) + \" \" + JSON.stringify(doc.media) + \" \" + doc.replyCount + \" \" + doc.repostCount + \" \" + doc.url + \" \" + JSON.stringify(doc.links) + \" \" + JSON.stringify(doc.tags) + \" \" + doc.title + \" \" + doc.group + \" \" + doc.replyTo;\n        index('content', doc.content, {\"store\": \"yes\", \"field\": \"content\"});\n        index('user', doc.user, {\"store\": \"yes\", \"field\": \"user\"});\n        if (doc.replies) {\n            index('replies', JSON.stringify(doc.replies), {\"store\": \"yes\", \"field\": \"replies\"});\n        }\n        if (doc.media) {\n            index('media', JSON.stringify(doc.media), {\"store\": \"yes\", \"field\": \"media\"});\n        }\n        index('replyCount', doc.replyCount, {\"store\": \"yes\", \"field\": \"replyCount\"});\n        index('repostCount', doc.repostCount, {\"store\": \"yes\", \"field\": \"repostCount\"});\n        index('url', doc.url, {\"store\": \"yes\", \"field\": \"url\"});\n        if (doc.links) {\n            index('links', JSON.stringify(doc.links), {\"store\": \"yes\", \"field\": \"links\"});\n        }\n        if (doc.tags) {\n            index('tags', JSON.stringify(doc.tags), {\"store\": \"yes\", \"field\": \"tags\"});\n        }\n        index('title', doc.title, {\"store\": \"yes\", \"field\": \"title\"});\n        index('group', doc.group, {\"store\": \"yes\", \"field\": \"group\"});\n        index('replyTo', doc.replyTo, {\"store\": \"yes\", \"field\": \"replyTo\"});\n    }\n    if (doc.dtype == \"Breach\") {\n        var total = doc.total + \" \" + doc.description + \" \" + doc.url;\n        index('total', doc.total, {\"store\": \"yes\", \"field\": \"total\"});\n        index('description', doc.description, {\"store\": \"yes\", \"field\": \"description\"});\n        index('url', doc.url, {\"store\": \"yes\", \"field\": \"url\"});\n    }\n    if (doc.dtype == \"Email\") {\n        var total = doc.user + \" \" + doc.domain + \" \" + doc.password;\n        index('user', doc.user, {\"store\": \"yes\", \"field\": \"user\"});\n        index('domain', doc.domain, {\"store\": \"yes\", \"field\": \"domain\"});\n        index('password', doc.password, {\"store\": \"yes\", \"field\": \"password\"});\n    }\n    if (doc.dtype == \"EmailMessage\") {\n        var total = doc.body + \" \" + doc.subject + \" \" + doc.to + \" \" + doc.fromF + \" \" + doc.headers + \" \" + JSON.stringify(doc.cc) + \" \" + JSON.stringify(doc.bcc);\n        index('body', doc.body, {\"store\": \"yes\", \"field\": \"body\"});\n        index('subject', doc.subject, {\"store\": \"yes\", \"field\": \"subject\"});\n        index('to', doc.to, {\"store\": \"yes\", \"field\": \"to\"});\n        index('fromF', doc.fromF, {\"store\": \"yes\", \"field\": \"fromF\"});\n        if (doc.cc) {\n            index('cc', JSON.stringify(doc.cc), {\"store\": \"yes\", \"field\": \"cc\"});\n        }\n        if (doc.bcc) {\n            index('bcc', JSON.stringify(doc.bcc), {\"store\": \"yes\", \"field\": \"bcc\"});\n        }\n    }\n    if (doc.dtype == \"User\") {\n        var total = doc.url + \" \" + doc.name + \" \" + doc.platform + \" \" + JSON.stringify(doc.misc) + \" \" + doc.bio;\n        index('url', doc.url, {\"store\": \"yes\", \"field\": \"url\"});\n        index('name', doc.name, {\"store\": \"yes\", \"field\": \"name\"});\n        index('platform', doc.platform, {\"store\": \"yes\", \"field\": \"platform\"});\n        if (doc.misc) {\n            index('misc', JSON.stringify(doc.misc), {\"store\": \"yes\", \"field\": \"misc\"});\n        }\n        index('bio', doc.bio, {\"store\": \"yes\", \"field\": \"bio\"});\n    }\n      if (doc.dtype == \"Phone\") {\n        var total = doc.number + \" \" + doc.carrier + \" \" + doc.status + \" \" + doc.phone_type;\n        index('number', doc.number, {\"store\": \"yes\", \"field\": \"number\"});\n        index('carrier', doc.carrier, {\"store\": \"yes\", \"field\": \"carrier\"});\n        index('phone_type', doc.phone_type, {\"store\": \"yes\", \"field\": \"phone_type\"});\n    }\n    \n    if (doc.dtype == \"Web\") {\n        var total = doc.source;\n        index('source', doc.source, {\"store\": \"yes\", \"field\": \"source\"});\n    }\n    if (doc.dtype == \"Domain\") {\n        var total = doc.recordType + \" \" + doc.record + \" \" + doc.ip;\n        index('recordType', doc.recordType, {\"store\": \"yes\", \"field\": \"recordType\"});\n        index('record', doc.record, {\"store\": \"yes\", \"field\": \"record\"});\n        index('ip', doc.ip, {\"store\": \"yes\", \"field\": \"ip\"});\n    }\n    if (doc.dtype == \"Network\") {\n        var total = doc.org + \" \" + doc.asn.number + \" \" + doc.asn.subnet;\n        index('org', doc.org, {\"store\": \"yes\", \"field\": \"org\"});\n        index('asnNumber', doc.asn.number, {\"store\": \"yes\", \"field\": \"asnNumber\"});\n        index('subnet', doc.asn.subnet, {\"store\": \"yes\", \"field\": \"subnet\"});\n    }\n    if (doc.dtype == \"Host\") {\n        var total = doc.hostname + \" \" + doc.ip + \" \" + JSON.stringify(doc.ports) + \" \" + doc.os;\n        index('hostname', doc.hostname, {\"store\": \"yes\", \"field\": \"hostname\"});\n        index('ip', doc.ip, {\"store\": \"yes\", \"field\": \"ip\"});\n        if (doc.ports) {\n            index('ports', JSON.stringify(doc.ports), {\"store\": \"yes\", \"field\": \"ports\"});\n        }\n        index('os', doc.os, {\"store\": \"yes\", \"field\": \"os\"});\n    }\n    if (doc.dtype == \"Url\") {\n        var total = doc.url + \" \" + doc.content;\n        index('url', doc.url, {\"store\": \"yes\", \"field\": \"url\"});\n        index('content', doc.content, {\"store\": \"yes\", \"field\": \"content\"});\n    }\n\n    \n    \n}"}}}

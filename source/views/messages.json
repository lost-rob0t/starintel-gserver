{"_id":"_design/messages","language":"javascript","views":{"messages_by_user":{"map":"function(doc) { if (doc.dtype === 'message') { emit(doc.user, doc._id); } }","reduce":"_count"},"messages_by_platform":{"map":"function(doc){ \n  if (doc.dtype === \"message\"){ \n     emit(doc.platform, doc._id);  \n}}","reduce":"_count"},"messages_by_group":{"map":"function(doc) { if (doc.dtype === 'message') { emit(doc.group, doc._id); } }","reduce":"_count"},"social_posts_by_user":{"map":"function(doc) { if (doc.dtype.toLowerCase() === 'socialmpost') { emit(doc.user, doc._id); } }","reduce":"_count"},"social_posts_by_group":{"map":"function(doc) { if (doc.dtype === 'socialmediapost') { emit(doc.group, doc._id); } }","reduce":"_count"},"by_channel":{"map":"function(doc) {\n             if (doc.dtype === 'message') {\n               if (doc.message !== ''){\n               emit([doc.group, doc.channel], doc._id);\n             }}}","reduce":"_count"},"messages_by_channel_time":{"map":"function(doc) {\n        if (doc.dtype === 'message' && doc.dateAdded) {\n          emit([doc.dateAdded, doc.group, doc.channel], doc._id);\n        }\n      }","reduce":"function(keys, values, rereduce) {\n        if (rereduce) {\n          return values.flat().sort((a, b) => a.dateAdded - b.dateAdded);\n        } else {\n          return values.sort((a, b) => a.dateAdded - b.dateAdded);\n        }\n      }"},"social_posts_by_platform":{"map":"function(doc){ \n  if (doc.dtype.toLowerCase() === \"socialmpost\"){ \n     emit(doc.platform, doc._id);  \n}}","reduce":"_count"},"groups":{"reduce":"function(keys, values, rereduce) {\n  var channels = [];\n  \n  values.forEach(function(value) {\n    // Handle both initial reduce and rereduce cases\n    if (Array.isArray(value)) {\n      value.forEach(function(channel) {\n        if (channels.indexOf(channel) === -1) {\n          channels.push(channel);\n        }\n      });\n    } else if (typeof value === 'string') {\n      if (channels.indexOf(value) === -1) {\n        channels.push(value);\n      }\n    }\n  });\n  \n  return channels.sort();\n}","map":"function(doc) {\n  if (doc.dtype === 'message' && doc.group && doc.channel) {\n    emit(doc.group, doc.channel);\n  }\n}"}}}
